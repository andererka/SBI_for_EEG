Warning: no DISPLAY environment variable.
--No graphics will be displayed.
Running 50 simulations.:   0%|          | 0/50 [00:00<?, ?it/s]Running 50 simulations.:   2%|▏         | 1/50 [00:55<45:33, 55.79s/it]Running 50 simulations.:   4%|▍         | 2/50 [01:52<45:17, 56.61s/it]Running 50 simulations.:   6%|▌         | 3/50 [02:49<44:27, 56.76s/it]Running 50 simulations.:   8%|▊         | 4/50 [03:46<43:35, 56.85s/it]Running 50 simulations.:  10%|█         | 5/50 [04:45<43:04, 57.42s/it]Running 50 simulations.:  12%|█▏        | 6/50 [05:43<42:14, 57.59s/it]Running 50 simulations.:  14%|█▍        | 7/50 [06:41<41:20, 57.68s/it]Running 50 simulations.:  16%|█▌        | 8/50 [07:38<40:17, 57.56s/it]Running 50 simulations.:  18%|█▊        | 9/50 [08:36<39:23, 57.65s/it]Running 50 simulations.:  20%|██        | 10/50 [09:34<38:35, 57.90s/it]Running 50 simulations.:  22%|██▏       | 11/50 [10:33<37:53, 58.30s/it]Running 50 simulations.:  24%|██▍       | 12/50 [11:32<37:00, 58.44s/it]Running 50 simulations.:  26%|██▌       | 13/50 [12:29<35:49, 58.09s/it]Running 50 simulations.:  28%|██▊       | 14/50 [13:27<34:49, 58.04s/it]Running 50 simulations.:  30%|███       | 15/50 [14:25<33:51, 58.06s/it]Running 50 simulations.:  32%|███▏      | 16/50 [15:26<33:16, 58.72s/it]Running 50 simulations.:  34%|███▍      | 17/50 [16:25<32:19, 58.78s/it]Running 50 simulations.:  36%|███▌      | 18/50 [17:22<31:10, 58.47s/it]Running 50 simulations.:  38%|███▊      | 19/50 [18:20<30:07, 58.32s/it]Running 50 simulations.:  40%|████      | 20/50 [19:18<29:07, 58.24s/it]Running 50 simulations.:  42%|████▏     | 21/50 [20:27<29:41, 61.43s/it]Running 50 simulations.:  44%|████▍     | 22/50 [22:05<33:48, 72.46s/it]Running 50 simulations.:  46%|████▌     | 23/50 [23:43<35:57, 79.91s/it]Running 50 simulations.:  48%|████▊     | 24/50 [25:21<37:00, 85.42s/it]Running 50 simulations.:  50%|█████     | 25/50 [26:59<37:11, 89.28s/it]Running 50 simulations.:  52%|█████▏    | 26/50 [28:39<36:57, 92.38s/it]Running 50 simulations.:  54%|█████▍    | 27/50 [30:23<36:47, 95.99s/it]Running 50 simulations.:  56%|█████▌    | 28/50 [32:03<35:37, 97.16s/it]Running 50 simulations.:  58%|█████▊    | 29/50 [33:43<34:16, 97.92s/it]Running 50 simulations.:  60%|██████    | 30/50 [35:25<33:02, 99.12s/it]Running 50 simulations.:  62%|██████▏   | 31/50 [37:06<31:35, 99.78s/it]Running 50 simulations.:  64%|██████▍   | 32/50 [38:46<29:56, 99.83s/it]Running 50 simulations.:  66%|██████▌   | 33/50 [40:26<28:14, 99.71s/it]Running 50 simulations.:  68%|██████▊   | 34/50 [42:05<26:35, 99.74s/it]Running 50 simulations.:  70%|███████   | 35/50 [43:45<24:53, 99.59s/it]Running 50 simulations.:  72%|███████▏  | 36/50 [45:26<23:21, 100.14s/it]Running 50 simulations.:  74%|███████▍  | 37/50 [47:05<21:37, 99.78s/it] Running 50 simulations.:  76%|███████▌  | 38/50 [48:44<19:54, 99.58s/it]Running 50 simulations.:  78%|███████▊  | 39/50 [50:21<18:06, 98.78s/it]Running 50 simulations.:  80%|████████  | 40/50 [51:59<16:25, 98.51s/it]Running 50 simulations.:  82%|████████▏ | 41/50 [53:36<14:42, 98.01s/it]Running 50 simulations.:  84%|████████▍ | 42/50 [55:13<13:02, 97.83s/it]Running 50 simulations.:  86%|████████▌ | 43/50 [56:49<11:21, 97.35s/it]Running 50 simulations.:  88%|████████▊ | 44/50 [58:27<09:45, 97.50s/it]Running 50 simulations.:  90%|█████████ | 45/50 [1:00:05<08:08, 97.75s/it]Running 50 simulations.:  92%|█████████▏| 46/50 [1:01:45<06:33, 98.36s/it]Running 50 simulations.:  94%|█████████▍| 47/50 [1:03:24<04:55, 98.50s/it]Running 50 simulations.:  96%|█████████▌| 48/50 [1:05:05<03:18, 99.15s/it]Running 50 simulations.:  98%|█████████▊| 49/50 [1:06:46<01:39, 99.79s/it]Running 50 simulations.: 100%|██████████| 50/50 [1:08:27<00:00, 100.25s/it]Running 50 simulations.: 100%|██████████| 50/50 [1:08:27<00:00, 82.16s/it] 
Drawing 100 posterior samples:   0%|          | 0/100 [00:00<?, ?it/s]Drawing 100 posterior samples:  75%|███████▌  | 75/100 [00:00<00:00, 152.66it/s]Drawing 100 posterior samples: 7428it [00:00, 12777.91it/s]                     
Traceback (most recent call last):
  File "ERP_simulation_and_inference.py", line 103, in <module>
    file_writer.save_all(posterior, prior, theta=theta, x =x, fig=fig)
  File "/mnt/qb/home/macke/kanderer29/sbi_for_eeg_data/code/data_load_writer/write_to_file.py", line 100, in save_all
    self.save_posterior(posterior)
  File "/mnt/qb/home/macke/kanderer29/sbi_for_eeg_data/code/data_load_writer/write_to_file.py", line 51, in save_posterior
    expand += 1
UnboundLocalError: local variable 'expand' referenced before assignment
